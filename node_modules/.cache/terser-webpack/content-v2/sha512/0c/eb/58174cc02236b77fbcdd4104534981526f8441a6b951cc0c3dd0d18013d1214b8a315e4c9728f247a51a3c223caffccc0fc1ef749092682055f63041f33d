{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{\"7K4d\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"UploadModule\",(function(){return upload_module_UploadModule}));var common=__webpack_require__(\"ofXK\"),router=__webpack_require__(\"tyNb\"),core=__webpack_require__(\"fXoL\"),switchMap=__webpack_require__(\"eIep\"),angular_fire_auth=__webpack_require__(\"UbJi\"),angular_fire_firestore=__webpack_require__(\"I/3d\");let upload_service_UploadService=(()=>{class UploadService{constructor(afAuth,db){this.afAuth=afAuth,this.db=db}deleteFile(fileId){return this.db.collection(\"files\").doc(fileId).delete()}getUserFiles(){return this.afAuth.authState.pipe(Object(switchMap.a)(user=>user?this.db.collection(\"files\",ref=>ref.where(\"uid\",\"==\",user.uid)).valueChanges({idField:\"id\"}):[]))}}return UploadService.ɵfac=function(t){return new(t||UploadService)(core.Wb(angular_fire_auth.a),core.Wb(angular_fire_firestore.a))},UploadService.ɵprov=core.Jb({token:UploadService,factory:UploadService.ɵfac,providedIn:\"root\"}),UploadService})(),dropzone_directive_DropzoneDirective=(()=>{class DropzoneDirective{constructor(){this.dropped=new core.n,this.hovered=new core.n}onDrop($event){$event.preventDefault(),this.dropped.emit($event.dataTransfer.files),this.hovered.emit(!1)}onDragOver($event){$event.preventDefault(),this.hovered.emit(!0)}onDragLeave($event){$event.preventDefault(),this.hovered.emit(!1)}}return DropzoneDirective.ɵfac=function(t){return new(t||DropzoneDirective)},DropzoneDirective.ɵdir=core.Ib({type:DropzoneDirective,selectors:[[\"\",\"dropzone\",\"\"]],hostBindings:function(rf,ctx){1&rf&&core.ac(\"drop\",(function($event){return ctx.onDrop($event)}))(\"dragover\",(function($event){return ctx.onDragOver($event)}))(\"dragleave\",(function($event){return ctx.onDragLeave($event)}))},outputs:{dropped:\"dropped\",hovered:\"hovered\"}}),DropzoneDirective})();var tslib_es6=__webpack_require__(\"mrSG\"),tap=__webpack_require__(\"vkgz\"),finalize=__webpack_require__(\"nYR2\"),angular_fire_storage=__webpack_require__(\"Vaw3\");function UploadTaskComponent_div_0_Template(rf,ctx){if(1&rf&&(core.Sb(0,\"div\"),core.Ob(1,\"progress\",1),core.rc(2),core.dc(3,\"number\"),core.Rb()),2&rf){const pct_r2=ctx.ngIf;core.Cb(1),core.hc(\"value\",pct_r2),core.Cb(1),core.tc(\" \",core.ec(3,2,pct_r2),\"%\\n\")}}function UploadTaskComponent_div_2_div_2_Template(rf,ctx){if(1&rf&&(core.Sb(0,\"div\"),core.Sb(1,\"h3\"),core.rc(2,\"Results!\"),core.Rb(),core.Ob(3,\"img\",3),core.Ob(4,\"br\"),core.Sb(5,\"a\",4),core.rc(6,\"Download Me!\"),core.Rb(),core.Rb()),2&rf){const url_r5=ctx.ngIf;core.Cb(3),core.hc(\"src\",url_r5,core.lc),core.Cb(2),core.hc(\"href\",url_r5,core.lc)}}function UploadTaskComponent_div_2_Template(rf,ctx){if(1&rf){const _r7=core.Tb();core.Sb(0,\"div\"),core.rc(1),core.qc(2,UploadTaskComponent_div_2_div_2_Template,7,2,\"div\",0),core.Sb(3,\"button\",2),core.ac(\"click\",(function(){return core.kc(_r7),core.cc().task.pause()})),core.rc(4,\"Pause\"),core.Rb(),core.Sb(5,\"button\",2),core.ac(\"click\",(function(){return core.kc(_r7),core.cc().task.cancel()})),core.rc(6,\"Cancel\"),core.Rb(),core.Sb(7,\"button\",2),core.ac(\"click\",(function(){return core.kc(_r7),core.cc().task.resume()})),core.rc(8,\"Resume\"),core.Rb(),core.Rb()}if(2&rf){const snap_r3=ctx.ngIf,ctx_r1=core.cc();core.Cb(1),core.uc(\" \",snap_r3.bytesTransferred,\" of \",snap_r3.totalBytes,\" \"),core.Cb(1),core.hc(\"ngIf\",ctx_r1.downloadURL),core.Cb(1),core.hc(\"disabled\",!ctx_r1.isActive(snap_r3)),core.Cb(2),core.hc(\"disabled\",!ctx_r1.isActive(snap_r3)),core.Cb(2),core.hc(\"disabled\",!(\"paused\"===(null==snap_r3?null:snap_r3.state)))}}let upload_task_component_UploadTaskComponent=(()=>{class UploadTaskComponent{constructor(storage,db,afAuth){this.storage=storage,this.db=db,this.afAuth=afAuth}ngOnInit(){this.startUpload()}startUpload(){const path=`test/${Date.now()}_${this.file.name}`,ref=this.storage.ref(path);this.task=this.storage.upload(path,this.file),this.percentage=this.task.percentageChanges(),this.snapshot=this.task.snapshotChanges().pipe(Object(tap.a)(console.log),Object(finalize.a)(()=>Object(tslib_es6.a)(this,void 0,void 0,(function*(){const user=yield this.afAuth.currentUser;this.downloadURL=yield ref.getDownloadURL().toPromise(),this.db.collection(\"files\").add({uid:user.uid,downloadURL:this.downloadURL,path:path})}))))}isActive(snapshot){return\"running\"===snapshot.state&&snapshot.bytesTransferred<snapshot.totalBytes}}return UploadTaskComponent.ɵfac=function(t){return new(t||UploadTaskComponent)(core.Nb(angular_fire_storage.a),core.Nb(angular_fire_firestore.a),core.Nb(angular_fire_auth.a))},UploadTaskComponent.ɵcmp=core.Hb({type:UploadTaskComponent,selectors:[[\"upload-task\"]],inputs:{file:\"file\"},decls:4,vars:6,consts:[[4,\"ngIf\"],[\"max\",\"100\",3,\"value\"],[3,\"disabled\",\"click\"],[2,\"width\",\"100px\",3,\"src\"],[\"target\",\"_blank\",\"rel\",\"noopener\",3,\"href\"]],template:function(rf,ctx){1&rf&&(core.qc(0,UploadTaskComponent_div_0_Template,4,4,\"div\",0),core.dc(1,\"async\"),core.qc(2,UploadTaskComponent_div_2_Template,9,6,\"div\",0),core.dc(3,\"async\")),2&rf&&(core.hc(\"ngIf\",core.ec(1,2,ctx.percentage)),core.Cb(2),core.hc(\"ngIf\",core.ec(3,4,ctx.snapshot)))},directives:[common.l],pipes:[common.b,common.e],styles:[\".dropzone[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;min-width:80vw;font-weight:200;height:300px;border:2px dashed #f16624;border-radius:5px;background:#fff;margin:10px 0}.dropzone.hovering[_ngcontent-%COMP%]{border:2px solid #f16624;color:#dadada!important}.dropzone[_ngcontent-%COMP%]   .file-label[_ngcontent-%COMP%]{font-size:1.2em}progress[_ngcontent-%COMP%]::-webkit-progress-value{-webkit-transition:width .1s ease;transition:width .1s ease}\"]}),UploadTaskComponent})();function UploaderComponent_div_7_Template(rf,ctx){if(1&rf&&(core.Sb(0,\"div\"),core.Ob(1,\"upload-task\",2),core.Rb()),2&rf){const file_r1=ctx.$implicit;core.Cb(1),core.hc(\"file\",file_r1)}}let uploader_component_UploaderComponent=(()=>{class UploaderComponent{constructor(){this.files=[]}toggleHover(event){this.isHovering=event}onDrop(files){for(let i=0;i<files.length;i++)this.files.push(files.item(i))}}return UploaderComponent.ɵfac=function(t){return new(t||UploaderComponent)},UploaderComponent.ɵcmp=core.Hb({type:UploaderComponent,selectors:[[\"uploader\"]],decls:8,vars:3,consts:[[\"dropzone\",\"\",1,\"dropzone\",3,\"hovered\",\"dropped\"],[4,\"ngFor\",\"ngForOf\"],[3,\"file\"]],template:function(rf,ctx){1&rf&&(core.Sb(0,\"div\",0),core.ac(\"hovered\",(function($event){return ctx.toggleHover($event)}))(\"dropped\",(function($event){return ctx.onDrop($event)})),core.Sb(1,\"h3\"),core.rc(2,\"AngularFire Drop Zone\"),core.Rb(),core.Sb(3,\"p\"),core.rc(4,\"Drag and Drop a File\"),core.Rb(),core.Rb(),core.Sb(5,\"h3\"),core.rc(6,\"Uploads\"),core.Rb(),core.qc(7,UploaderComponent_div_7_Template,2,1,\"div\",1)),2&rf&&(core.Eb(\"hovering\",ctx.isHovering),core.Cb(7),core.hc(\"ngForOf\",ctx.files))},directives:[dropzone_directive_DropzoneDirective,common.k,upload_task_component_UploadTaskComponent],styles:[\".dropzone[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;min-width:80vw;font-weight:200;height:300px;border:2px dashed #f16624;border-radius:5px;background:#fff;margin:10px 0}.dropzone.hovering[_ngcontent-%COMP%]{border:2px solid #f16624;color:#dadada!important}.dropzone[_ngcontent-%COMP%]   .file-label[_ngcontent-%COMP%]{font-size:1.2em}progress[_ngcontent-%COMP%]::-webkit-progress-value{-webkit-transition:width .1s ease;transition:width .1s ease}\"]}),UploaderComponent})();var card=__webpack_require__(\"Wp6s\"),fesm2015_button=__webpack_require__(\"bTqV\");function FileListComponent_mat_card_3_Template(rf,ctx){if(1&rf&&(core.Sb(0,\"mat-card\",2),core.Sb(1,\"mat-card-header\"),core.Sb(2,\"mat-card-title\"),core.rc(3),core.Rb(),core.Sb(4,\"mat-card-subtitle\"),core.rc(5,\"uploaded image\"),core.Rb(),core.Rb(),core.Ob(6,\"img\",3),core.Sb(7,\"mat-card-content\"),core.Sb(8,\"p\"),core.rc(9,\" Lorem ipsum dolor sit amet consectetur adipisicing elit. Tenetur molestias natus odit commodi, laboriosam similique neque atque odio inventore distinctio minima, quaerat harum nesciunt? Sapiente velit voluptate assumenda voluptates magnam unde consectetur, fugit id ab? Officiis libero odit in! In totam, accusantium doloremque neque ipsam officia ipsa commodi? Eius, quis. \"),core.Rb(),core.Rb(),core.Sb(10,\"mat-card-actions\"),core.Sb(11,\"button\",4),core.Sb(12,\"a\",5),core.rc(13,\"Download Me!\"),core.Rb(),core.Rb(),core.Sb(14,\"button\",6),core.rc(15,\"SHARE\"),core.Rb(),core.Sb(16,\"button\",7),core.rc(17,\"Find Matches\"),core.Rb(),core.Rb(),core.Rb()),2&rf){const file_r1=ctx.$implicit;core.Cb(3),core.sc(file_r1.path),core.Cb(3),core.hc(\"src\",file_r1.downloadURL,core.lc),core.Cb(6),core.hc(\"href\",file_r1.downloadURL,core.lc)}}const routes=[{path:\"\",component:(()=>{class FileListComponent{constructor(fileService){this.fileService=fileService}ngOnInit(){this.sub=this.fileService.getUserFiles().subscribe(files=>this.files=files),console.log(this.files)}}return FileListComponent.ɵfac=function(t){return new(t||FileListComponent)(core.Nb(upload_service_UploadService))},FileListComponent.ɵcmp=core.Hb({type:FileListComponent,selectors:[[\"app-file-list\"]],decls:8,vars:1,consts:[[1,\"file-container\"],[\"class\",\"example-card\",4,\"ngFor\",\"ngForOf\"],[1,\"example-card\"],[\"mat-card-image\",\"\",\"alt\",\"Photo of a Shiba Inu\",3,\"src\"],[\"mat-button\",\"\",\"color\",\"primary\"],[\"target\",\"_blank\",\"rel\",\"noopener\",3,\"href\"],[\"mat-button\",\"\"],[\"mat-button\",\"\",\"color\",\"warn\"]],template:function(rf,ctx){1&rf&&(core.Sb(0,\"h2\"),core.rc(1,\"Current Files\"),core.Rb(),core.Sb(2,\"div\",0),core.qc(3,FileListComponent_mat_card_3_Template,18,3,\"mat-card\",1),core.Rb(),core.Sb(4,\"div\",0),core.Sb(5,\"h2\"),core.rc(6,\"Upload\"),core.Rb(),core.Ob(7,\"uploader\"),core.Rb()),2&rf&&(core.Cb(3),core.hc(\"ngForOf\",ctx.files))},directives:[common.k,uploader_component_UploaderComponent,card.a,card.d,card.h,card.g,card.e,card.c,card.b,fesm2015_button.b],styles:[\".example-card[_ngcontent-%COMP%]{max-width:400px;margin-top:1em}.example-header-image[_ngcontent-%COMP%]{background-image:url(https://material.angular.io/assets/img/examples/shiba1.jpg);background-size:cover}.file-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}\"]}),FileListComponent})()}];let upload_routing_module_UploadRoutingModule=(()=>{class UploadRoutingModule{}return UploadRoutingModule.ɵmod=core.Lb({type:UploadRoutingModule}),UploadRoutingModule.ɵinj=core.Kb({factory:function(t){return new(t||UploadRoutingModule)},imports:[[router.d.forChild(routes)],router.d]}),UploadRoutingModule})();var material_module=__webpack_require__(\"hctd\");let upload_module_UploadModule=(()=>{class UploadModule{}return UploadModule.ɵmod=core.Lb({type:UploadModule}),UploadModule.ɵinj=core.Kb({factory:function(t){return new(t||UploadModule)},imports:[[common.c,upload_routing_module_UploadRoutingModule,material_module.a]]}),UploadModule})()}}]);","extractedComments":[]}